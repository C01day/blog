---
layout: post
title: åšå®¢çš„æ­å»ºä¸éƒ¨ç½²
subtitle: æ­å»ºé™æ€ç½‘é¡µï¼Œå¹¶éƒ¨ç½²åœ¨ Github pages æˆ– Vercel ä¸Š
author: "C01day"
date: 2021-08-08
header_style: image # text
header_img: /img/in-post/cover/118.jpg
catalog: true
tags:
  - æ­å»ºåšå®¢
---

## å‡†å¤‡å¥½ç¯å¢ƒ
æ¯å®Œæˆä¸€æ­¥å°±å»æ‰ä¸€ä¸ªæ ‡ç­¾å§~
<TagsOfEnvironment/>

### åšå®¢æºä»£ç 
å¯ä»¥ä» Github ä¸Šä¸‹è½½æˆ‘çš„[åšå®¢æºä»£ç ](https://github.com/C01day/blog)ã€‚

### VSCode
[VSCode](https://code.visualstudio.com/) æ˜¯ä¸€ä¸ªæˆ‘ç”¨çš„æ¯”è¾ƒé¡ºæ‰‹çš„ç¼–è¾‘å™¨ã€‚

### Node.js
æ€ä¹ˆå°‘å¾—äº† [Node.js](https://nodejs.org/en/) è¯­è¨€å‘¢ï¼Ÿ

è¯·åœ¨å®‰è£…åæ£€æŸ¥æœ‰æ— `npm`å‘½ä»¤ï¼Œè‹¥æ²¡æœ‰åˆ™éœ€è¦å°†`nodejs/`è·¯å¾„æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ã€‚

### Github è´¦å·å’Œä»“åº“

éƒ¨ç½²è¦ç”¨åˆ° Github pages æˆ– Vercel ï¼Œæˆ‘ä»¬å°†ä»£ç æ–‡ä»¶æ”¾åœ¨ Github ä¸Šã€‚å› æ­¤éœ€è¦åˆ›å»ºä¸€ä¸ªè´¦å·ï¼Œå¹¶æ–°å»ºä¸€ä¸ªé¡¹ç›®ä»“åº“(repositories)ç”¨æ¥å­˜å‚¨é¡¹ç›®æ–‡ä»¶ï¼Œåå­—å»ºè®®ä¸º`<USERNAME>.github.io`ï¼Œ`<USERNAME>`ä¸ºä½ çš„ Github ç”¨æˆ·åï¼Œè¿™æ ·èƒ½å…å»è®¾ç½®`Base`çš„éº»çƒ¦ã€‚
::: tip
README.mdæ–‡ä»¶å»ºè®®å‹¾ä¸Š
:::

### Git
è¦å°†æ–‡ä»¶ä¸Šä¼ åˆ° Github ï¼Œéœ€è¦ç”¨åˆ° [Git](https://git-scm.com/downloads) ç‰ˆæœ¬æ§åˆ¶å·¥å…·ã€‚

#### é…ç½®ç”¨æˆ·åå’Œé‚®ç®±
æ‰“å¼€ Git æ–‡ä»¶å¤¹ä¸‹çš„ Git Bash ï¼Œé…ç½®ç”¨æˆ·åå’Œé‚®ç®±
``` sh
git config --global user.name "your username"
git config --global user.email "your email"
```
æ£€æŸ¥ç»ˆç«¯æœ‰æ— `git`å‘½ä»¤ï¼Œè‹¥æ²¡æœ‰åˆ™éœ€è¦å°†`Git/bin/`è·¯å¾„æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ã€‚

#### é…ç½® SSH key
ç¬¬ä¸€æ¬¡ä½¿ç”¨ Git éœ€è¦é…ç½®SSHå¯†é’¥ï¼Œæ¥è·å¾—è¯»å–è¿œç¨‹ä»“åº“çš„æƒé™ï¼Œè¯¦ç»†çš„æ–¹æ³•å¯ä»¥å‚è€ƒå®˜ç½‘æä¾›çš„[ç”ŸæˆSSHå¯†é’¥æ•™ç¨‹](https://docs.github.com/cn/github/authenticating-to-github/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent)ã€‚

ä¾ç„¶æ‰“å¼€ Git Bash ï¼Œè¾“å…¥å‘½ä»¤
``` sh
ssh-keygen -t rsa -C "youremail@example.com"
```
ä¸€ç›´å›è½¦ï¼Œä½¿ç”¨é»˜è®¤è·¯å¾„å³å¯ã€‚

ä¹‹ååœ¨`C:\Users\ä¸»æœºå\.ssh`è·¯å¾„ä¸‹ä¼šæœ‰`id_rsa`å’Œ`id_rsa.pub`ä¸¤ä¸ªæ–‡ä»¶ã€‚

åˆ° Github è´¦å·çš„`Settings->SSH and GPG keys`é‡Œæ‰¾åˆ°`SSH keys`ï¼Œæ–°å»ºä¸€ä¸ª`SSH key`ï¼Œå°†`id_rsa.pub`æ–‡ä»¶é‡Œçš„å†…å®¹å¤åˆ¶è¿›å»ä¾¿å¯ã€‚
<div align=center>
![](https://i.loli.net/2021/08/08/HdM3ESgFB8G6Cvu.png)
</div>

### Github Desktop
GitHub Desktop æ˜¯ä¸€ä¸ªå¯ä»¥ä¸ GitHub äº¤äº’çš„åº”ç”¨ç¨‹åºï¼Œå¯ä»¥åœ¨[å®˜ç½‘](https://desktop.github.com/)ä¸­ä¸‹è½½ã€‚

å…·ä½“çš„ä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒ[GitHub Desktop æ–‡æ¡£](https://docs.github.com/cn/desktop)ã€‚å¦‚æœGithubä¸Šæœ‰ä»“åº“ï¼Œå°±å…‹éš†è¿œç¨‹ä»“åº“åˆ°æœ¬åœ°ï¼›å¦‚æœæ²¡æœ‰çš„è¯ä¹Ÿå¯ä»¥åœ¨ Github Desktop ä¸­ç›´æ¥åˆ›å»ºã€‚æ–‡æ¡£ä¸­éƒ½æœ‰è¯¦ç»†çš„ä»‹ç»ã€‚
<div align=center>
![windows-file-menu.png](https://i.loli.net/2021/08/08/t6eQ1Nx5bidBvcy.png)
</div>

::: tip æäº¤æ›´æ–°

è¦æäº¤ä»£ç çš„æ›´æ–°åˆ°è¿œç¨‹ä»“åº“ï¼Œé¦–å…ˆéœ€è¦ç‚¹å‡»å·¦ä¸‹è§’çš„ commit æŒ‰é’®
<div align=center>
![click-commit-to-master.png](https://i.loli.net/2021/08/07/hDSAyJBC6Hb7tIL.png)
</div>

ç„¶åç‚¹å‡»ä¸Šé¢çš„ push ï¼Œå³å¯æäº¤æ›´æ–°ã€‚ç”±äº Github è®¿é—®é€Ÿåº¦è¿‡æ…¢ï¼Œå¯èƒ½ä¼šè¶…æ—¶æŠ¥é”™ï¼Œå¤šè¯•å‡ æ¬¡å³å¯ï¼Œæˆ–è€…ç”¨ VPN åŠ é€Ÿã€‚
<div align=center>
![push-to-origin.png](https://i.loli.net/2021/08/07/UbQZaCvpOMJoAnI.png)
</div>
:::

## è¯•ç€ç¼–è¯‘æºä»£ç 
æ‰€éœ€è¦çš„ç¯å¢ƒé…ç½®å®Œäº†ï¼Œæ¥ä¸‹æ¥è¯•ç€ç¼–è¯‘æºä»£ç å§~

### Yarn
`yarn`å’Œ`npm`ä¸€æ ·ï¼Œéƒ½æ˜¯åŒ…ç®¡ç†å·¥å…·ã€‚ç”¨`npm`æ¥å…¨å±€å®‰è£…`yarn`
``` sh
npm install -g yarn
```

ä¹‹åè¿è¡Œ`yarn install`çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå‡ºç°`åœ¨æ­¤ç³»ç»Ÿä¸Šç¦æ­¢è¿è¡Œæ­¤è„šæœ¬`çš„æŠ¥é”™ã€‚æ‰€ä»¥ç”¨ç®¡ç†å‘˜èº«ä»½æ‰“å¼€`PowerShell`ï¼Œä½¿ç”¨å‘½ä»¤æ›´æ”¹è®¡ç®—æœºçš„æ‰§è¡Œç­–ç•¥
``` sh
set-ExecutionPolicy RemoteSigned
```
ç„¶åè¾“å…¥`Y`è¡¨ç¤º`æ˜¯`ã€‚è®¾ç½®å®Œä¹‹åå¯ä»¥é€šè¿‡`get-ExecutionPolicy`å‘½ä»¤æŸ¥çœ‹æ‰§è¡Œç­–ç•¥æ˜¯å¦ä¸º`RemoteSigned`ã€‚

æ¥ä¸‹æ¥å°±æ˜¯å®‰è£…ä¾èµ–äº†
``` sh
yarn install
```
æˆåŠŸåä¼šå‡ºç°`node_modules`æ–‡ä»¶å¤¹ã€‚

### ç¼–è¯‘
``` sh
yarn run dev
```
OKï¼Œç¼–è¯‘æˆåŠŸäº†ï¼Œç‚¹è¿›ç½‘å€çœ‹çœ‹æ•ˆæœ~
::: danger
è®°å¾—åœ¨éƒ¨ç½²ä¹‹å‰ï¼Œå°†`/.vuepress/config.js`é‡Œçš„`comment`å’Œ`analytics`é…ç½®æ³¨é‡Šæ‰ï¼Œåˆ†åˆ«æ˜¯è¯„è®ºå’Œåˆ†æå·¥å…·ã€‚
:::

## ç½‘ç«™çš„éƒ¨ç½²
æœ‰äº†åˆæ­¥çš„ç½‘ç«™ï¼Œå°±å¯ä»¥éƒ¨ç½²äº†ã€‚

éƒ¨ç½²ä¹‹ååˆ«äººå¯ä»¥ç›´æ¥é€šè¿‡ç½‘å€è®¿é—®ï¼Œæˆ–è€…åœ¨æœç´¢å¼•æ“ä¸­æœç´¢å…³é”®å­—è®¿é—®ã€‚

è™½ç„¶éƒ¨ç½²æ˜¯ä¸€ä»¶éº»çƒ¦äº‹ï¼Œä½†ç”±äºåªæ˜¯é™æ€ç½‘é¡µï¼Œå› æ­¤é€‰æ‹©éƒ¨ç½²åœ¨ Github pages æˆ– vercel ä¸Šï¼Œèƒ½çœä¸‹ä¸å°‘æ­¥éª¤ã€‚

### Github pages éƒ¨ç½²
åœ¨éƒ¨ç½²ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª gh-pages åˆ†æ”¯ï¼Œä¹‹åå°†æ‰“åŒ…ä»¥åçš„é™æ€æ–‡ä»¶æ”¾åœ¨ gh-pages åˆ†æ”¯ä¸­ã€‚
<div align=center>
![new-branch-button-mac.png](https://i.loli.net/2021/08/08/pRsED7tQ8WkSVqu.png)
</div>

ç„¶ååœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹æ–°å»ºæ–‡ä»¶`deploy.sh`ä½œä¸ºæ‰“åŒ…å‘½ä»¤çš„è„šæœ¬ï¼Œä»£ç å¦‚ä¸‹ï¼š

``` sh
#!/usr/bin/env sh

# ç¡®ä¿è„šæœ¬æŠ›å‡ºé‡åˆ°çš„é”™è¯¯
set -e

# ç”Ÿæˆé™æ€æ–‡ä»¶
npm run build

# è¿›å…¥ç”Ÿæˆçš„æ–‡ä»¶å¤¹
cd docs/.vuepress/dist

# å¦‚æœæ˜¯å‘å¸ƒåˆ°è‡ªå®šä¹‰åŸŸå
# echo 'c01day.com' > CNAME

git init
git add -A
git commit -m 'deploy'

# å¦‚æœå‘å¸ƒåˆ° https://<USERNAME>.github.io
git push -f git@github.com:<USERNAME>/<USERNAME>.github.io.git master:gh-pages

# å¦‚æœå‘å¸ƒåˆ° https://<USERNAME>.github.io/<REPO>
# git push -f git@github.com:<USERNAME>/<REPO>.git master:gh-pages
            
cd -
```

<br/><br/>
::: tip è§£é‡Š
- `npm run build`æ‰“åŒ…å‘½ä»¤ç”Ÿæˆçš„é™æ€æ–‡ä»¶åœ¨`docs/.vuepress/dist`ä¸­ï¼Œä¹‹åå°†å…¶ä¸Šä¼ åˆ°`gh-pages`åˆ†æ”¯ä¸Šã€‚å¯ä»¥åœ¨`config.js`ä¸­ç”¨destæŒ‡å®šæ‰“åŒ…è·¯å¾„ã€‚
- å°†`git push`å‘½ä»¤ä¸­çš„`<USERNAME>`æ›¿æ¢ä¸ºè‡ªå·± Github è´¦å·çš„ç”¨æˆ·åã€‚
- åœ¨VSCodeèœå•æ ç‚¹å‡»æ‰“å¼€ç»ˆç«¯ï¼Œæˆ–è€…ç”¨å¿«æ·é”®`` Ctrl+` ``ï¼ˆåœ¨é”®ç›˜å·¦ä¸Šè§’ï¼‰ï¼Œåœ¨å‘½ä»¤è¡Œä¸­ç”¨`sh`å‘½ä»¤è¿è¡Œæ–‡ä»¶ã€‚
- 
``` sh
sh deploy.sh
```

:::

`gh-pages`ä»£ç ä¸Šä¼ å®Œä¹‹åï¼Œç‚¹å‡»é¡¹ç›®çš„`Settings->Pages`ï¼Œé€‰æ‹©`gh-pages`ä½œä¸ºèµ„æº
<div align=center>
![](https://i.loli.net/2021/08/08/A7bRWK5vEqwf4H6.png)
</div>

ç„¶åå°±ä¼šå‡ºç°ç½‘å€
<div align=center>
![](https://i.loli.net/2021/08/08/NMFbwlsng3TjC8p.png)
</div>

å½“ç„¶ï¼Œä¸Šé¢çš„å‘½ä»¤æ˜¯å°†é™æ€æ–‡ä»¶æäº¤åˆ°`gh-pages`åˆ†æ”¯ä¸Šï¼Œä¹Ÿåˆ«å¿˜äº†å°†ä»£ç æ›´æ–°æäº¤åˆ°ä¸»åˆ†æ”¯`main`ä¸Šã€‚

### Vercel éƒ¨ç½²

ç”±äºåœ¨ Github pages ä¸Šéƒ¨ç½²çš„ç½‘é¡µä¸èƒ½è¢«ç™¾åº¦èœ˜è››çˆ¬å–åˆ°ï¼Œå› æ­¤æˆ‘ä»¬è¿ç§»åˆ° Vercel ã€‚å½“ç„¶ï¼Œè¦æ˜¯ä¸æ€ä¹ˆåœ¨ä¹ç™¾åº¦æ˜¯å¦æ”¶å½•ï¼Œå¯ä»¥è·³è¿‡æ­¤èŠ‚ã€‚

#### æ›´æ”¹ dest
ä¹‹å‰æ‰“åŒ…çš„è·¯å¾„ä¸º`docs/.vuepress/dist`ï¼Œç”±äº Vercel ä¸Šéƒ¨ç½²é¡¹ç›®çš„`Preview Branches`ä¼šåœ¨åˆ†æ”¯ä¸­æ‰“åŒ…å¹¶å¯»æ‰¾`public`æ–‡ä»¶ï¼Œå› æ­¤éœ€è¦åœ¨`config.js`ä¸­è®¾ç½® dest ï¼Œå°†æ‰“åŒ…æ–‡ä»¶è·¯å¾„æ”¹ä¸º`public`ï¼š

``` js
// .vuepress/config.js
module.exports = {
  dest: 'public',
}
```
å¹¶å°†ä¹‹å‰`deploy.sh`ä¸­çš„`cd docs/.vuepress/dist`æ”¹ä¸º
``` sh
# deploy.sh
# åŸæ¥æ˜¯ cd docs/.vuepress/dist
cd public
```

ç„¶åå°†ä¹‹å‰`docs/.vuepress/dist`è·¯å¾„ä¸‹çš„æ–‡ä»¶åˆ é™¤ï¼Œå¹¶å°è¯•`build`ä¸€æ¬¡ã€‚

#### å¯¼å…¥é¡¹ç›®

é¦–å…ˆåœ¨[vercelå®˜ç½‘](https://vercel.com/)æ³¨å†Œè´¦å·ã€‚ä¹‹ååˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œå¯¼å…¥ Github ä¸Šçš„ä»“åº“ï¼Œæ­¥éª¤é»˜è®¤å³å¯ã€‚

ä¸è®ºæœ‰æ²¡æœ‰éƒ¨ç½²æˆåŠŸï¼Œå…ˆè·³åˆ°ä¸‹ä¸€æ­¥æŠŠ`Production Branch`æ”¹äº†ã€‚

#### æ›´æ”¹`Production Branch`
æˆ‘ä»¬éœ€è¦å°†`Production Branch`æ›´æ”¹ä¸º`gh-pages`åˆ†æ”¯ï¼Œè®©`main`åˆ†æ”¯ä½œä¸º`Preview Branches`ã€‚

å…¶å®å°±å’Œä¹‹å‰ Github pages çš„éƒ¨ç½²ä¸€æ ·ï¼Œå°†`gh-pages`åˆ†æ”¯çš„é™æ€æ–‡ä»¶ä½œä¸ºç½‘é¡µæºä»£ç ã€‚

æ­¥éª¤å¾ˆç®€å•ï¼Œåˆ°é¡¹ç›®çš„`Settings->Git`ï¼Œæ‰¾åˆ°`Production Branch`ï¼ŒæŠŠåˆ†æ”¯ä»`main`æ”¹ä¸º`gh-pages`å°±è¡Œã€‚
<div align=center>
![](https://i.loli.net/2021/08/08/ykie23LXMzKZqvu.png)
</div>

ä¹‹åä»»æ„æäº¤ä¸€æ¬¡æ›´æ–°åˆ°`gh-pages`åˆ†æ”¯ä¸Šï¼ŒVercel å°±ä¼šè‡ªåŠ¨éƒ¨ç½²äº†ï¼Œå¯ä»¥ç‚¹å‡»æŸ¥çœ‹éƒ¨ç½²çš„ç½‘ç«™ã€‚
<div align=center>
![](https://i.loli.net/2021/08/08/Xx62VvJ7UqBfzFg.png)
</div>

## è‡ªå®šä¹‰åŸŸå
è¦è‡ªå®šä¹‰åŸŸåï¼Œé¦–å…ˆéœ€è¦ä¹°ä¸€ä¸ªåŸŸåï¼ŒæœåŠ¡å•†éšæ„ï¼Œæˆ‘ç”¨çš„æ˜¯é˜¿é‡Œäº‘ã€‚ä¹‹åå®åè®¤è¯ç­‰æ­¥éª¤ä¸å†èµ˜è¿°ã€‚
### Github pages è‡ªå®šä¹‰åŸŸå
#### é…ç½®åŸŸåè§£æ

è½¬åˆ°åŸŸåæœåŠ¡å•†åå°çš„åŸŸåè§£æï¼Œæ·»åŠ å¦‚ä¸‹ä¸¤æ¡è®°å½•ï¼š
<div align=center>
![](https://i.loli.net/2021/08/08/IKlnEGsAwpxHVQ3.png)
</div>

::: tip æç¤º
- è®°å½•å€¼ä¸º`<USERNAME>.github.io`ï¼Œ`<USERNAME>`ä¸ºä½ çš„ Github ç”¨æˆ·åã€‚
- è®°å½•ç±»å‹é€‰æ‹© CNAME ã€‚
- ä¸»æœºè®°å½•åˆ†åˆ«ä¸º`www`å’Œ`@`ï¼Œ`@`ä¹Ÿå°±æ˜¯ä¸å¡«ä¸»æœºè®°å½•çš„é»˜è®¤å€¼ã€‚
- å¦‚æœé¡¹ç›®åœ¨å…¶ä»–ä»“åº“ï¼Œè®°å½•å€¼åŒæ ·ä¸º`<USERNAME>.github.io`ã€‚
:::

#### é…ç½® CNAME
é¦–å…ˆåœ¨`<USERNAME>.github.io`ä»“åº“é¦–é¡µæ–°å»ºä¸€ä¸ªæ–‡ä»¶`CNAME`ï¼ˆå¦‚æœé¡¹ç›®åœ¨å…¶ä»–ä»“åº“ï¼Œä¹Ÿæ˜¯åœ¨`<USERNAME>.github.io`ä»“åº“ä¸­é…ç½®åŸŸåï¼‰ï¼Œå†…å®¹ä¸ºä½ çš„åŸŸåï¼Œä¾‹å¦‚
``` CNAME
c01day.com
``` 
å¹¶å°†`deploy.sh`æ–‡ä»¶ä¸­çš„ä»¥ä¸‹å†…å®¹å»æ‰æ³¨é‡Šï¼ŒåŒæ ·æ¢ä¸ºè‡ªå·±çš„åŸŸå
``` sh
# å¦‚æœæ˜¯å‘å¸ƒåˆ°è‡ªå®šä¹‰åŸŸå
# echo 'c01day.com' > CNAME
```

ä¹‹ååœ¨ä»“åº“ä¸­çš„`Settings->Pages`ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°`Custom domain`ä¼šå˜ä¸ºè‡ªå·±çš„åŸŸåã€‚
<div align=center>
![](https://i.loli.net/2021/08/08/rBHfhzLJVqZKl2C.png)
</div>

åœ¨ä¸Šé¢ä¼šå‡ºç°ç½‘å€ï¼Œä¸º`https://www.XXX.com/`ï¼Œä¾‹å¦‚`https://www.c01day.com/`ã€‚

#### å¦‚æœæ˜¯è‡ªå®šä¹‰ä»“åº“åº”è¯¥æ€ä¹ˆåš
**<font color=red>ä»¥ä¸Šæ‰€æåˆ°çš„ä»“åº“é»˜è®¤ä¸º`<USERNAME>.github.io`ï¼Œå¦‚æœé¡¹ç›®åœ¨å…¶ä»–è‡ªå®šä¹‰ä»“åº“ä¸­ï¼Œè¯·çœ‹ä¸‹é¢æç¤ºï¼ˆä»¥ä»“åº“å`blog`ä¸ºä¾‹ï¼‰</font>**

::: tip å¦‚æœé¡¹ç›®åœ¨è‡ªå®šä¹‰ä»“åº“
- åŸŸåè§£æé…ç½®ä¸å˜ï¼Œå’Œä¸Šé¢ä¸€æ ·ã€‚
- CNAME æ–‡ä»¶ä¾ç„¶æ”¾åˆ°`<USERNAME>.github.io`ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæœ€å¥½æœ‰ä¸€ä¸ª`<USERNAME>.github.io`ä»“åº“ã€‚
- `deploy.sh`æ–‡ä»¶ä¸­çš„`echo 'XXX.com' > CNAME`å°±ä¸ç”¨äº†ã€‚
- åœ¨ä»£ç çš„`config.js`ä¸­ï¼Œæ·»åŠ `base: "/<REPO>/",`ï¼Œ`<REPO>`ä¸ºè‡ªå®šä¹‰ä»“åº“åï¼Œä¾‹å¦‚`blog`
``` js
// .vuepress/config.js
module.exports = {
  base: "/<REPO>/",
  // ä¾‹å¦‚ base: "/blog/",
}
```
- åœ¨`.md`æ–‡ä»¶ä¸­ï¼Œå›¾ç‰‡çš„å¼•ç”¨è·¯å¾„è¦åŠ ä¸Š`$withBase`ï¼Œæ³¨æ„`src`æ˜¯`v-bind`è¯­æ³•ï¼Œå‰é¢æœ‰ä¸ª`:`ã€‚
``` html
<img :src="$withBase('/XXX.png')"/>
```
:::

ä¹‹åï¼Œåˆ°è‡ªå®šä¹‰ä»“åº“çš„`Settings->Pages`ä¸­å¯ä»¥çœ‹åˆ°ï¼Œéƒ¨ç½²çš„ç½‘å€ä¸º`https://www.XXX.com/<REPO>/`ï¼Œä¾‹å¦‚`https://www.c01day.com/blog/`ã€‚

### Vercel è‡ªå®šä¹‰åŸŸå
::: danger æ³¨æ„
åŒä¸€ä¸ªåŸŸåä¸èƒ½åŒæ—¶ç”¨åœ¨ Github pages å’Œ Vercel ä¸Šã€‚
:::
åœ¨ Vercel åˆšåˆšéƒ¨ç½²é¡¹ç›®çš„`Settings->Domains`ä¸­ï¼Œæ·»åŠ è‡ªå·±çš„åŸŸå
<div align=center>
![](https://i.loli.net/2021/08/08/kFftuxGcmKzw3XN.png)
</div>

æŒ‰ç…§ç»™çš„æç¤ºï¼Œæ·»åŠ ä¸¤æ¡è§£æ
<div align=center>
![](https://i.loli.net/2021/08/08/W6KMcksqv7FhdD8.png)
</div>

::: tip æç¤º
- æ³¨æ„è¦å°†ä¹‹å‰ Github pages ä¸­è®¾ç½®çš„åŸŸåè§£æåˆ é™¤ï¼Œå› ä¸ºæ˜¯äº’æ–¥çš„ã€‚
- å¹¶ä¸æ¸…æ¥šå…¶ä»–äººçš„IPæ˜¯ä¸æ˜¯ä¹Ÿä¸º76.76.21.21ï¼Œæ®è¯´æœ‰äº›IPè¢«å¢™äº†ã€‚
:::

ç„¶åå°±é…ç½®å®Œæˆäº†ï¼Œå¹¶ä¸”ç­¾å‘äº†è¯ä¹¦
<div align=center>
![](https://i.loli.net/2021/08/08/yrW29GHwPmscolQ.png)
</div>

## å¦‚ä½•è®©ç™¾åº¦å’ŒGoogleæœç´¢åˆ°ï¼Ÿ

### ç”Ÿæˆç«™ç‚¹åœ°å›¾ sitemap
ç«™ç‚¹åœ°å›¾`sitemap.xml`æ˜¯ä¸ºäº†è®©èœ˜è››æ›´å¥½åœ°çˆ¬å–åˆ°æˆ‘ä»¬çš„ç½‘é¡µã€‚æˆ‘ä»¬éœ€è¦å®‰è£…ç”Ÿæˆç«™ç‚¹åœ°å›¾çš„æ’ä»¶
``` sh
npm install vuepress-plugin-sitemap
```
ç„¶ååœ¨pluginsä¸­å¯¼å…¥
``` js
// .vuepress/config.js
module.exports = {
  plugins: {
    'sitemap': {
      hostname: 'https://www.c01day.com/' //ä¸ºä½ çš„è‡ªå®šä¹‰åŸŸå
    }
  }
}
```
ä¹‹åæ¯æ¬¡`build`åéƒ½ä¼šåœ¨é™æ€èµ„æºæ–‡ä»¶å¤¹ä¸­ç”Ÿæˆ`sitemap.xml`æ–‡ä»¶ï¼Œç”¨æ¥ä¸Šä¼ åˆ°ç™¾åº¦ç«™é•¿å’Œ Google Search Console ã€‚

### ç™¾åº¦ç«™é•¿
ç™»å½•ç™¾åº¦ç«™é•¿ï¼Œæ·»åŠ è‡ªå·±çš„ç½‘å€ï¼Œä¼šæœ‰ä¸‰ç§æ–¹å¼éªŒè¯ä½ å¯¹ç½‘ç«™çš„æ‰€å±æƒï¼Œä¸‹é¢éƒ½æœ‰å…·ä½“çš„æ“ä½œæ­¥éª¤
<div align=center>
![](https://i.loli.net/2021/08/08/OCLGjJ4vd27A6yl.png)
</div>

éªŒè¯å®Œåæäº¤è‡ªå·±çš„`sitemap.xml`ï¼Œä¾‹å¦‚
<div align=center>
![](https://i.loli.net/2021/08/08/1HFt37JVdyRQCsc.png)
</div>

### Google Search Console
åŒæ ·ï¼Œåˆ°[Google Search Console](https://search.google.com/search-console/about)ä¸­æ·»åŠ ç½‘å€
<div align=center>
![](https://i.loli.net/2021/08/08/uI5Ta9yNxg7iPBH.png)
</div>

æˆ‘ä¸€èˆ¬é€‰æ‹©å³è¾¹çš„ã€‚

åŒæ ·ï¼Œæœ‰å‡ ç§æ–¹å¼éªŒè¯æ‰€å±æƒ
<div align=center>
![](https://i.loli.net/2021/08/08/G6T3NMHgelmoF4a.png)
</div>

ä¹‹ååŒæ ·æäº¤ç«™ç‚¹åœ°å›¾å°±è¡Œã€‚

å¯ä»¥é€‰æ‹©è¯·æ±‚ç¼–å…¥ç´¢å¼•
<div align=center>
![](https://i.loli.net/2021/08/08/6SGp7harcekRPo9.png)
</div>

ç½‘ç«™æ”¶å½•åä¼šå˜æˆè¿™æ ·
<div align=center>
![](https://i.loli.net/2021/08/08/duPNOK9HMfm83Tj.png)
</div>

OKï¼Œç°åœ¨æ‰€æœ‰çš„éƒ½å·²ç»è®²å®Œäº†ï¼Œå¯èƒ½æœ‰å¾ˆå¤šç»†èŠ‚æ²¡æœ‰æ¶‰åŠåˆ°ï¼Œä¹Ÿå¯èƒ½æœ‰å¾ˆå¤šé”™è¯¯å’Œä¸å®Œå–„çš„åœ°æ–¹ï¼Œæˆ‘ä¹Ÿæ­£åœ¨å°è¯•ç€å»è§£å†³ã€‚ğŸ˜‡

é¡ºå¸¦ä¸€æï¼Œç™¾åº¦æ”¶å½•å¾—æ˜¯çœŸçš„æ…¢è¯¶ğŸ™ƒ

## åç»­

### Vssueç™»å½•ä¼šè·³åˆ°ç½‘ç«™é¦–é¡µ
åº”è¯¥æ˜¯`.md`æ–‡ä»¶åä¸­æœ‰ä¸­æ–‡/ç‰¹æ®Šå­—ç¬¦çš„åŸå› ï¼Œå¯¼è‡´åœ°å€è§£æä¸æ­£ç¡®ï¼Œä¼šé‡å®šå‘åˆ°`Authorization callback URL`ï¼Œä¹Ÿå°±æ˜¯åœ¨`OAuth Apps`é‡Œé…ç½®çš„é¦–é¡µã€‚

### lastUpdated ä¸ä¼šå®æ—¶æ›´æ–°
``` js
// blog/.vuepress/config.js
module.exports = {
  plugins:[
    [
      '@vuepress/last-updated', 
      {
        transformer: (timestamp, lang) => {
          const moment = require("moment");
          moment.locale(lang);
          return moment(timestamp).fromNow();
        }
      }
    ],
  ]
}
```
è™½ç„¶ä¼šæ˜¾ç¤ºä¸Šæ¬¡æ›´æ–°äºå‡ å¤©å‰ï¼Œä½†ä¸è®ºè¿‡å¤šä¹…è¿˜æ˜¯æ˜¾ç¤ºåŒæ ·çš„å†…å®¹ã€‚

æºä»£ç çš„`lastUpdated`æ˜¯æ”¾åœ¨`computed`é‡Œçš„ï¼Œæ® vue å®˜ç½‘ä¸Šçš„è§£é‡Šï¼Œ`Date`æ—¥æœŸä¹‹ç±»çš„ä¸æ˜¯å“åº”å¼ä¾èµ–ï¼Œè®¡ç®—å±æ€§å°†ä¸å†æ›´æ–°ã€‚äºæ˜¯æˆ‘è¯•ç€å°†`lastUpdated`æ”¾åœ¨`mounted`é‡Œï¼Œå‘ç°è¿˜æ˜¯ä¸è¡Œã€‚

æ²¡åŠæ³•ï¼Œè¿˜æ˜¯ç”¨å›`moment(timestamp).format("YYYY-MM-DD HH:mm");`å§ğŸ™ƒ

### é…ç½®é¦–é¡µçš„æ ‡ç­¾é¡µæ ‡é¢˜
æ ‡ç­¾é¡µæ ‡é¢˜å°±æ˜¯æµè§ˆå™¨æœ€ä¸Šé¢çš„æ–‡å­—ï¼Œåœ¨ä¸»é¡µçš„æ—¶å€™æ˜¾ç¤ºçš„æ˜¯Postsï¼Œæˆ‘æƒ³æ”¹ä¸ºHomeã€‚è¯¢é—®äº†[ä½œè€…å¤§ä½¬](https://zxh.io/)åï¼Œæ‰¾åˆ°äº†è§£å†³æ–¹æ³•ï¼š

åœ¨`packages/theme-gungnir/index.js`ä¸­`@vuepress/plugin-blog`çš„å¦‚ä¸‹éƒ¨åˆ†æ·»åŠ `title: "Home"`ä¾¿å¯ğŸ¤—
<div align=center>
![](https://i.loli.net/2021/08/09/PUgq8LxjHVlZJ6p.png)
</div>

### Github Actions è‡ªåŠ¨éƒ¨ç½²
å¿ƒè¡€æ¥æ½®ï¼Œå…ˆè¯•è¯•å¥½ä¸å¥½ç”¨~

è¿™æ®µ action ï¼ˆç”±[vuepresså®˜æ–¹](https://v2.vuepress.vuejs.org/zh/guide/deployment.html#github-pages)æä¾›ï¼‰çš„åŠŸèƒ½æ˜¯åœ¨æˆ‘ push åˆ° main åˆ†æ”¯çš„æ—¶å€™è‡ªåŠ¨ build ï¼Œç„¶åå°†æ‰“åŒ…åçš„é™æ€æ–‡ä»¶ä¸Šä¼ åˆ° gh-pages åˆ†æ”¯ä¸Šã€‚

é¦–å…ˆåœ¨ç”¨æˆ·çš„`Settings->Developer settings`ä¸­æ–°å»ºä¸€ä¸ª`Personal access tokens`ï¼Œåå­—å«`ACCESS_TOKEN`ï¼Œæƒé™é€‰æ‹©`repo`å°±è¡Œã€‚

ç„¶ååœ¨è¦è‡ªåŠ¨éƒ¨ç½²çš„ä»“åº“çš„`Settings->secrets`ä¸­æ–°å»ºä¸€ä¸ªåä¸º`ACCESS_TOKEN`çš„`secret`ï¼Œå°†ä¹‹å‰è·å¾—çš„ TOKEN å¤åˆ¶ä¸Šå»ã€‚

``` yml
# .github\workflows\deploy.yml
name: build and deploy

on:
  # æ¯å½“ push åˆ° main åˆ†æ”¯æ—¶è§¦å‘éƒ¨ç½²
  push:
    branches: [main]
  # æ‰‹åŠ¨è§¦å‘éƒ¨ç½²
  workflow_dispatch:

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    env:
      TZ: Asia/Shanghai
    steps:
      - name: Checkout
        uses: actions/checkout@v2
        with:
          # â€œæœ€è¿‘æ›´æ–°æ—¶é—´â€ ç­‰ git æ—¥å¿—ç›¸å…³ä¿¡æ¯ï¼Œéœ€è¦æ‹‰å–å…¨éƒ¨æäº¤è®°å½•
          fetch-depth: 0

      - name: Setup Node.js
        uses: actions/setup-node@v2
        with:
          # é€‰æ‹©è¦ä½¿ç”¨çš„ node ç‰ˆæœ¬
          node-version: "14"

      # ç¼“å­˜ node_modules
      - name: Cache dependencies
        uses: actions/cache@v2
        id: yarn-cache
        with:
          path: |
            **/node_modules
          key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
          restore-keys: |
            ${{ runner.os }}-yarn-

      # å¦‚æœç¼“å­˜æ²¡æœ‰å‘½ä¸­ï¼Œå®‰è£…ä¾èµ–
      - name: Install dependencies
        if: steps.yarn-cache.outputs.cache-hit != 'true'
        run: yarn --frozen-lockfile

      # è¿è¡Œæ„å»ºè„šæœ¬
      - name: Build VuePress site
        run: yarn build

      # æŸ¥çœ‹ workflow çš„æ–‡æ¡£æ¥è·å–æ›´å¤šä¿¡æ¯
      # @see https://github.com/JamesIves/github-pages-deploy-action
      - name: Deploy to GitHub Pages
        uses: JamesIves/github-pages-deploy-action@releases/v3
        with:
          ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }}
          # éƒ¨ç½²åˆ° gh-pages åˆ†æ”¯
          BRANCH: gh-pages
          # éƒ¨ç½²ç›®å½•ä¸º VuePress çš„è¾“å‡ºç›®å½•
          FOLDER: public
```
::: info tip
ä¸è¿‡æµ‹è¯•äº†ä¸€æ¬¡åå‘ç°`lastUpdated`çš„æ—¶åŒºä¸å¯¹ï¼Œäºæ˜¯åœ¨ä¸Šè¿°ä»£ç çš„`env`éƒ¨åˆ†æ·»åŠ äº†åœ°åŒºã€‚
:::

### giscusè¯„è®º

åˆ°[giscuså®˜ç½‘](https://giscus.app/)ä¸­æŒ‰ç…§æµç¨‹é…ç½®ä¸€ä¸‹ï¼Œä¼šè·å¾—ä¸€æ®µ`<script>`ä»£ç ï¼Œç„¶åå¤åˆ¶åˆ°ç›¸åº”ä½ç½®å³å¯ã€‚

ç›®å‰æ²¡è§£å†³çš„é—®é¢˜ï¼š
- å“åº”å¼ï¼ˆè¯„è®ºéšç€æ–‡ç« åˆ‡æ¢ï¼‰
- æ·±è‰²ä¸»é¢˜ï¼ˆä¸»é¢˜åˆ‡æ¢åè¯„è®ºåŒºè¿˜æ˜¯ç™½è‰²ï¼‰

