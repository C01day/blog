---
layout: post
title: æ­å»ºåšå®¢çš„æ—¥å¸¸
subtitle: æˆ‘å°±æ˜¯èœå•Š
author: "C01day"
date: 2021-08-06
header_style: image # text
header_img: /img/in-post/cover/110.jpg
catalog: true
tags:
  - æ­å»ºåšå®¢
---

## é€‰æ‹©ä¸»é¢˜
ä¹‹å‰ç”¨vuepressçš„é»˜è®¤ä¸»é¢˜å†™äº†ä¸€ä¸ªæ­å»ºåšå®¢çš„æ•™ç¨‹ï¼Œå¼„äº†å¾ˆå¤šå°æ’ä»¶ï¼Œæœ‰ä¸€ç‚¹å°å°çš„æˆå°±æ„Ÿã€‚ä¸è¿‡é»˜è®¤ä¸»é¢˜æ›´é€‚åˆå†™ç”µå­ä¹¦ï¼Œä¸å¤ªé€‚åˆä½œä¸ºåšå®¢æ¥ä½¿ç”¨ã€‚
äºæ˜¯è¯•ç€æ‰¾æ‰¾å…¶ä»–ä¸»é¢˜ï¼Œä½†vuepressçš„ç”Ÿæ€å®åœ¨æ˜¯ä¸å¤ªè¡Œï¼Œä¸»é¢˜å¾ˆå°‘ã€‚æ‰“ç®—è½¬hexoï¼Œå®˜ç½‘é‡Œçš„chicä¸»é¢˜è›®å–œæ¬¢çš„ï¼Œå¾ˆç®€æ´ï¼Œä½†èº«ä¸ºèµ„æ·±æ‡’ğŸ•ï¼Œè¿˜æ˜¯ä¸å¤ªæƒ³å­¦æ–°æ¡†æ¶ã€‚
æœ€ååœ¨githubä¸Šä¸€ä¸ªä¸ªåœ°çœ‹demoï¼Œçœ‹åˆ°gungnirï¼Œæ„Ÿè§‰å¾ˆä¸é”™ï¼Œä¼˜é›…è€Œä¸å¤±ç®€çº¦ï¼Œå°±å†³å®šæ˜¯ä½ äº†ï¼Œçš®å¡ä¸˜ã€‚

## å¤§è‡ªç„¶çš„æ¬è¿å·¥
åœ¨ä¹‹å‰åšå®¢çš„åŸºç¡€ä¸Šï¼ŒæŒ‰ç…§æ–‡æ¡£å¼„äº†ä¸€ä¸‹ï¼Œä¸»é¡µæ€ä¹ˆä¹Ÿæ˜¾ç¤ºä¸äº†ï¼Œå¯èƒ½æ˜¯ä¾èµ–åŒ…çš„é—®é¢˜ã€‚ç„¶åå°±ç›´æ¥copyäº†ä¸€ä¸‹ï¼Œå…ˆè¿è¡Œèµ·æ¥å†è¯´ã€‚
ç„¶åå°±æ¢äº†æ¢å†…å®¹ï¼Œçœ‹äº†çœ‹ä»£ç ï¼ŒæŠŠä¸»é¢˜è‡ªå¸¦çš„æ’ä»¶é…äº†èµ·æ¥ã€‚åœ¨é…ç½®vssueçš„æ—¶å€™å®‰è£…äº†ä¸€äº›æ²¡å¿…è¦çš„åŒ…ï¼Œå¯èƒ½åˆæ˜¯åŒ…ç»“æ„é—®é¢˜ï¼Œåªå¥½å›é€€ç‰ˆæœ¬äº†ã€‚

## åˆæ•´ä¸ä¼šäº†
ä¹‹å‰ç”¨çš„valineè™½ç„¶ä¸‘æ˜¯ä¸‘äº†ç‚¹ï¼Œä¸è¿‡æ”¯æŒåŒ¿åè¯„è®ºï¼Œè€Œä¸”è¿˜æœ‰è®¿é—®é‡ç»Ÿè®¡ï¼Œå°±è¯•ç€æŠŠæµè§ˆé‡çš„åŠŸèƒ½è¿è¿‡æ¥ã€‚
æœä¸å…¶ç„¶ï¼Œä¼—æœ›æ‰€å½’åœ°åˆç‚¸äº†ï¼Œè¿˜æ˜¯åŒ…ç»“æ„çš„é—®é¢˜ï¼Œä¹‹å‰npmå’Œyarnæ··ç€ç”¨ï¼Œè€Œä¸”yarnè¿˜ä¼šè­¦å‘Šworkspaceä»€ä¹ˆçš„ï¼Œä¹Ÿæ²¡å»è§£å†³ï¼Œå¾ˆéš¾å—ï¼Œä¹Ÿä¸çŸ¥é“ä»¥åä¼šä¸ä¼šåˆå‡ºç±»ä¼¼çš„é—®é¢˜ã€‚

## Vssueç™»å½•ä¼šè·³åˆ°ç½‘ç«™é¦–é¡µ
åº”è¯¥æ˜¯`.md`æ–‡ä»¶åä¸­æœ‰ä¸­æ–‡/ç‰¹æ®Šå­—ç¬¦çš„åŸå› ï¼Œå¯¼è‡´åœ°å€è§£æä¸æ­£ç¡®ï¼Œä¼šé‡å®šå‘åˆ°`Authorization callback URL`ï¼Œä¹Ÿå°±æ˜¯åœ¨`OAuth Apps`é‡Œé…ç½®çš„é¦–é¡µã€‚

## lastUpdated ä¸ä¼šå®æ—¶æ›´æ–°
``` js
// blog/.vuepress/config.js
module.exports = {
  plugins:[
    [
      '@vuepress/last-updated', 
      {
        transformer: (timestamp, lang) => {
          const moment = require("moment");
          moment.locale(lang);
          return moment(timestamp).fromNow();
        }
      }
    ],
  ]
}
```
è™½ç„¶ä¼šæ˜¾ç¤ºä¸Šæ¬¡æ›´æ–°äºå‡ å¤©å‰ï¼Œä½†ä¸è®ºè¿‡å¤šä¹…è¿˜æ˜¯æ˜¾ç¤ºåŒæ ·çš„å†…å®¹ã€‚

æºä»£ç çš„`lastUpdated`æ˜¯æ”¾åœ¨`computed`é‡Œçš„ï¼Œæ® vue å®˜ç½‘ä¸Šçš„è§£é‡Šï¼Œ`Date`æ—¥æœŸä¹‹ç±»çš„ä¸æ˜¯å“åº”å¼ä¾èµ–ï¼Œè®¡ç®—å±æ€§å°†ä¸å†æ›´æ–°ã€‚äºæ˜¯æˆ‘è¯•ç€å°†`lastUpdated`æ”¾åœ¨`mounted`é‡Œï¼Œå‘ç°è¿˜æ˜¯ä¸è¡Œã€‚

æ²¡åŠæ³•ï¼Œè¿˜æ˜¯ç”¨å›`moment(timestamp).format("YYYY-MM-DD HH:mm");`å§ğŸ™ƒ

## é…ç½®é¦–é¡µçš„æ ‡ç­¾é¡µæ ‡é¢˜
æ ‡ç­¾é¡µæ ‡é¢˜å°±æ˜¯æµè§ˆå™¨æœ€ä¸Šé¢çš„æ–‡å­—ï¼Œåœ¨ä¸»é¡µçš„æ—¶å€™æ˜¾ç¤ºçš„æ˜¯Postsï¼Œæˆ‘æƒ³æ”¹ä¸ºHomeã€‚è¯¢é—®äº†[ä½œè€…å¤§ä½¬](https://zxh.io/)åï¼Œæ‰¾åˆ°äº†è§£å†³æ–¹æ³•ï¼š

åœ¨`packages/theme-gungnir/index.js`ä¸­`@vuepress/plugin-blog`çš„å¦‚ä¸‹éƒ¨åˆ†æ·»åŠ `title: "Home"`ä¾¿å¯ğŸ¤—
<div align=center>
![](https://i.loli.net/2021/08/09/PUgq8LxjHVlZJ6p.png)
</div>

## Github Actions è‡ªåŠ¨éƒ¨ç½²
å¿ƒè¡€æ¥æ½®ï¼Œå…ˆè¯•è¯•å¥½ä¸å¥½ç”¨~

è¿™æ®µ action ï¼ˆç”±[vuepresså®˜æ–¹](https://v2.vuepress.vuejs.org/zh/guide/deployment.html#github-pages)æä¾›ï¼‰çš„åŠŸèƒ½æ˜¯åœ¨æˆ‘ push åˆ° main åˆ†æ”¯çš„æ—¶å€™è‡ªåŠ¨ build ï¼Œç„¶åå°†æ‰“åŒ…åçš„é™æ€æ–‡ä»¶ä¸Šä¼ åˆ° gh-pages åˆ†æ”¯ä¸Šã€‚

é¦–å…ˆåœ¨ç”¨æˆ·çš„`Settings->Developer settings`ä¸­æ–°å»ºä¸€ä¸ª`Personal access tokens`ï¼Œåå­—å«`ACCESS_TOKEN`ï¼Œæƒé™é€‰æ‹©`repo`å°±è¡Œã€‚

ç„¶ååœ¨è¦è‡ªåŠ¨éƒ¨ç½²çš„ä»“åº“çš„`Settings->secrets`ä¸­æ–°å»ºä¸€ä¸ªåä¸º`ACCESS_TOKEN`çš„`secret`ï¼Œå°†ä¹‹å‰è·å¾—çš„ TOKEN å¤åˆ¶ä¸Šå»ã€‚

``` yml
# .github\workflows\deploy.yml
name: build and deploy

on:
  # æ¯å½“ push åˆ° main åˆ†æ”¯æ—¶è§¦å‘éƒ¨ç½²
  push:
    branches: [main]
  # æ‰‹åŠ¨è§¦å‘éƒ¨ç½²
  workflow_dispatch:

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    env:
      TZ: Asia/Shanghai
    steps:
      - name: Checkout
        uses: actions/checkout@v2
        with:
          # â€œæœ€è¿‘æ›´æ–°æ—¶é—´â€ ç­‰ git æ—¥å¿—ç›¸å…³ä¿¡æ¯ï¼Œéœ€è¦æ‹‰å–å…¨éƒ¨æäº¤è®°å½•
          fetch-depth: 0

      - name: Setup Node.js
        uses: actions/setup-node@v2
        with:
          # é€‰æ‹©è¦ä½¿ç”¨çš„ node ç‰ˆæœ¬
          node-version: "14"

      # ç¼“å­˜ node_modules
      - name: Cache dependencies
        uses: actions/cache@v2
        id: yarn-cache
        with:
          path: |
            **/node_modules
          key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
          restore-keys: |
            ${{ runner.os }}-yarn-

      # å¦‚æœç¼“å­˜æ²¡æœ‰å‘½ä¸­ï¼Œå®‰è£…ä¾èµ–
      - name: Install dependencies
        if: steps.yarn-cache.outputs.cache-hit != 'true'
        run: yarn --frozen-lockfile

      # è¿è¡Œæ„å»ºè„šæœ¬
      - name: Build VuePress site
        run: yarn build

      # æŸ¥çœ‹ workflow çš„æ–‡æ¡£æ¥è·å–æ›´å¤šä¿¡æ¯
      # @see https://github.com/JamesIves/github-pages-deploy-action
      - name: Deploy to GitHub Pages
        uses: JamesIves/github-pages-deploy-action@releases/v3
        with:
          ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }}
          # éƒ¨ç½²åˆ° gh-pages åˆ†æ”¯
          BRANCH: gh-pages
          # éƒ¨ç½²ç›®å½•ä¸º VuePress çš„è¾“å‡ºç›®å½•
          FOLDER: public
```
::: info tip
ä¸è¿‡æµ‹è¯•äº†ä¸€æ¬¡åå‘ç°`lastUpdated`çš„æ—¶åŒºä¸å¯¹ï¼Œäºæ˜¯åœ¨ä¸Šè¿°ä»£ç çš„`env`éƒ¨åˆ†æ·»åŠ äº†åœ°åŒºã€‚
:::

## giscusè¯„è®º

åˆ°[giscuså®˜ç½‘](https://giscus.app/)ä¸­æŒ‰ç…§æµç¨‹é…ç½®ä¸€ä¸‹ï¼Œä¼šè·å¾—ä¸€æ®µ`<script>`ä»£ç ï¼Œç„¶åå¤åˆ¶åˆ°ç›¸åº”ä½ç½®å³å¯ã€‚

ç›®å‰æ²¡è§£å†³çš„é—®é¢˜ï¼š
- å“åº”å¼ï¼ˆè¯„è®ºéšç€æ–‡ç« åˆ‡æ¢ï¼‰
- æ·±è‰²ä¸»é¢˜ï¼ˆä¸»é¢˜åˆ‡æ¢åè¯„è®ºåŒºè¿˜æ˜¯ç™½è‰²ï¼‰